<!DOCTYPE html>
<html ng-app="todoapp">
  <head>
      <meta charset="UTF-8">
  </head>
  <script src="build/angular.js"></script>
  <body ng-controller="TodoCtrl as todo">
  TODO:
    <div ng-repeat="t in todo.list">
      {{t.body}} - {{t.completed}}
    </div>

  <script src="build/angular-resource.js"></script>
  <script>
    var todoapp = new angular.module("todoapp", ["ngResource"]);

    todoapp.controller("TodoCtrl", function($scope, $resource)
    {
      var todo = this
      var server = $resource("/todo.json/:id", {id: '@id'}, {})
      todo.list = #{.}# // golang template insert

      if (!todo.list) { // if list not there, query server
        server.query(
          function(data) { // callback
            todo.list = data
          });
      }

      todo.get = function(index){
        if (!todo.list) {
          return
        }
        server.get({id: todo.list[index].id}, function(data) {
          todo.list[index] = data
        });
      }
    });
  </script>
  </body>
</html>